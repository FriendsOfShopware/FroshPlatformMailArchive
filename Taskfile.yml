version: '3'

env:
  CONSOLE: docker compose exec -it shopware ./bin/console
  COMPOSER: docker compose exec -it shopware composer
  CONTAINER: docker compose exec -it shopware

tasks:
  init:
    cmds:
      - task: start
      - $COMPOSER install
      - $CONSOLE plugin:refresh -s
      - $CONSOLE plugin:install -c -a FroshPlatformMailArchive
      - task: build

  console:
    cmds:
      - $CONSOLE {{.CLI_ARGS}}

  container:
    cmds:
      - $CONTAINER {{.CLI_ARGS}}

  composer:
    cmds:
      - $COMPOSER {{.CLI_ARGS}}

  build:
    cmds:
      - $CONTAINER bin/build-administration.sh

  start:
    cmds:
      - docker compose up -d

  stop:
    cmds:
      - docker compose down

  restart:
    cmds:
      - task: stop
      - task: start

  remove:
    cmds:
      - docker compose down -v

  reset:
    cmds:
      - task: remove
      - task: init

  clean:
    cmds:
      - $CONSOLE cache:clear
